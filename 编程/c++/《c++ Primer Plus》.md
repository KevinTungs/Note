# 内容提要

C++是在C语言基础上开发的一种**集面向对象编程、泛型编程和过程化编程于一体的编程语言，是C语言的超集**。本书根据2003年的**ISO/ANSI C++标准**编写

> **ANSI**(American National Standard Institute，美国国家标准协会)
>
> **ISO**(International Standard Organization，国际标准协会)

# 作者介绍

**Stephen Prata（史蒂芬·普拉达）教授**，在美国加州肯特菲尔得的马林学院教授天文、物理和计算机科学

# 前言

**本书在介绍C++特性的同时，讨论了基本C语言，使两者成为有机的整体**。书中介绍了C++的基本概念，并通过短小精悍的程序来阐明，这些程序都很容易复制和试验。书中还介绍了输入和输出，如何让程序执行重复性任务，如何让程序做出选择，处理数据的多种方式，以及如何使用函数等内容。另外，本书还讲述C++在C语言的基础上新增的很多特性，包括：

- 类和对象
- **继承**
- **多态、虚函数和RTTI（运行阶段类型识别）**
- 函数重载
- 引用变量
- **泛型（独立于类型的）编程**（这种技术是由模板和标准模板库（STL）提供的）
- **处理错误条件的异常机制**
- **管理函数、类和变量名的名称空间**

## 初级教程方法

初级教程提供问题和练习来检验您对知识的理解，从而适于自学或课堂教学

**本书的目标是，您阅读本书后，能够编写出可靠、高效的程序，并且觉得这是一种享受**

## 示例代码

本书中包含大量示例代码，其中大部分是完成的程序。**本书介绍的是通用C++，因此适用于任何计算机、操作系统和编译器**。书中的示例在Windows7系统、Macintosh OS X系统和Linux系统上进行了测试

> **Macintosh OS X** mac系统的一个版本

## 本书内容

### 第1章 预备知识

1. **Bjarne Stroustrup（本贾尼·斯特劳斯特卢普）**如何通过在C语言的基础上添加对面向对象编程的支持，在创造C++编程语言
2. 讨论**面向过程语言（如C语言）与面向对象语言（如C++）**之间的区别
3. ANSI/ISO在制定C++标准方面所做的工作
4. 创建C++程序的技巧，介绍了当前几种C++编译器使用的方法
5. 介绍了本书的一些约定

### 第2章 开始学习C++

1. 创建简单C++程序的步骤
2. **main()函数扮演的角色**和C++程序使用的一些语句
3. 使用预定义的cout和cin对象实现程序输出和输入
4. 如何创建和使用变量
5. **函数——C++的编程模块**

### 第3章 处理数据

1. C++提供了内置类型储存整数和浮点数
2. C++为每一种数据都提供了几个类型，本章将要讨论这些类型，包括创建变量和编写各种类型的变量
3. **C++是如何处理不同类型之间的隐式和显式转换的**

### 第4章 复合类型

1. C++让程序员能够使用基本的内置类型来创建更复杂的类型。**最高级的形式是类**
2. 数组（储存多个同类型的值）、结构（存储多个不同类型的值）、指针（标识内存位置）
2. 如何创建和储存文本字符串及如何使用C-风格字符数组和C++ string类来处理文本输入和输出
2. **学习C++处理内存分配的一些方法，包括用于显示地管理内存的new和delete运算符**

### 第5章 循环和关系表达式

1. for循环、while循环和do while循环，这些循环必须知道何时终止，C++的关系运算符使程序员能够创建测试来引导循环
2. 如何创建逐字符地读取和处理输入的循环
3. 如何创建二维数组以及如何使用嵌套循环来处理它们

### 第6章 分支语句和逻辑运算符

1. 如何使用if、if else和switch语句及条件运算符来控制程序流程
2. 如何使用逻辑运算符来表达决策测试
3. **介绍确认字符关系（如测试字符是数字还是非打印字符）的函数库cctype**
4. 简要地介绍文件输入/输出

### 第7章 函数——C++的编程模块

1. **函数是C++的基本编程部件**
2. 本章重点介绍C++函数与C函数的共同特性
3. 复习函数定义的通用格式
4. 了解**函数原型是如何提高程序可靠性的**
5. 如何编写函数来处理数组、字符串和结构
6. 学习有关递归的知识（即函数在什么情况下调用自身）以及如何用它来实现分而治之的策略
7. 介绍**函数指针**（使程序员通过函数参数来命令函数使用另一个函数）

### 第8章 函数探幽

1. **本章将探索C++中函数新增的特性，类设计中经常使用这些特性**
2. 学习**内联函数**（可以提高程序的执行速度，但会增加程序的长度）
3. 引用变量（提供了另一种将信息传递给函数的方式）
4. 默认参数（使函数能够自动为函数调用中省略的函数参数提供值）
5. 函数重载（使程序员能够创建多个参数列表不同的同名函数）
6. **函数模板（使程序员能够指定相关函数族的设计）**

### 第9章 内存模型和名称空间

1. 本章将讨论如何创建多文件程序
2. 介绍**分配内存的各种方式和管理内存的各种方式**
3. **介绍作用域、链接、名称空间**
4. **这些内容决定了变量在程序的哪些部分是可见的**

### 第10章 对象和类

1. **类是用户定义的类型**
2. **对象（如变量）是类的实例**
3. 本章介绍面向对象编程和类设计
4. **对象声明描述的是存储在对象中的信息以及可对对象执行的操作（类方法）**
5. 对象的某些组成部分对于外界来说是可见的（公有部分），而某些部分却是隐藏的（私有部分）
6. 特殊的类方法（构造函数和析构函数）在对象创建和释放时发挥作用
7. **了解如何使用类来实现ADT，如栈**

> 抽象数据类型（Abstract Data Type，ADT）是计算机科学中**具有类似行为的特定类别的数据结构的数学模型；或者具有类似语义的一种或多种程序设计语言的数据类型**。**抽象数据类型是间接定义的，通过其上的可执行的操作以及这些操作的效果的数学约束（与可能的代价）**

### 第11章 使用类

1. 在本章中，您将深入了解类
2. **了解运算符重载**（使得程序员能够定义与类对象一起使用的运算符，如+）
3. **学习友元函数**（这些函数可以访问外部世界不可访问的类数据）
4. **了解一些构造函数和重载运算符成员函数是如何被用来管理类类型转换的**

### 第12章 类和动态内存分配

1. 一般来说，**让类成员指向动态分配的内存很有用**（如果程序员在类构造函数中使用new来分配动态内存，就有责任提供适当的析构函数，定义显式拷贝构造函数和显式赋值运算符）
2. 本章介绍了在程序员没有提供显式定义时，将如何隐式地生成成员函数以及这些成员函数的行为
3. 通过使用**对象指针**，了解队列模拟问题，扩充类方面的知识

### 第13章 类继承

1. 在面向对象编程中，**继承是功能最强大的特性之一**（通过继承，派生类可以继承基类的特性，可重用基类代码）
2. 本章讨论**公有继承**，这种继承模拟了is-a关系（即派生对象是基对象的特例）
3. **有些继承关系是多态的**（意味着相同的方法名称可能导致依赖于对象类型的行为）
4. 要实现这种行为需要使用一种新的成员函数——**虚函数**
5. **有时使用抽象基类是实现继承关系的最佳方式**
6. 本章讨论了这些问题，说明了公有继承在什么情况下合适，在什么情况下不合适

### 第14章 C++中的代码重用

1. 公有继承只是代码重用的方法之一，本章将介绍其他几种方式
2. **包含**（一个类包含另一个类的对象）可以模拟has-a关系
3. 使用**私有继承和保护继承**来模拟这种关系
4. 说明了各种方法之间的区别
5. 学习**类模板**（使程序员能够使用泛型来定义类，然后使用模板根据具体类型创建特定的类）
6. 介绍**多重公有继承**（使用这种方式，一个类可以从多个类派生而来）

### 第15章 友元、异常和其他

1. 本章扩展了对友元的讨论，讨论了**友元类和友元成员函数**
2. 从**异常**开始介绍了C++的几项新特性（异常为处理程序异常提供了一种机制）
3. 学习**RTTI**，这种机制用来确定对象类型

> **RTTI**（Run-Time Type Identification)，通过运行时类型信息程序能够使用基类的指针或引用来检查这些指针或引用所指的对象的实际派生类型

4. 介绍**一种更安全的方法来替代不受限制的强制类型转换**

### 第16章 string类和标准模板库

1. 本章讨论C++语言中新增的一些类库
2. 对于传统的C-风格字符串来说，string是一种方便且功能强大的替代方式
3. **auto_ptr类**帮助管理动态分配的内存
4. **STL**提供了几种类容器（包括数组、队列、链表、集合和映射）的模板表示，还提供了高效的泛型算法库，这些算法可用于STL容器，也可用于常规数组
5. **模板类valarray**为数值数组提供了支持

### 第17章 输入、输出和文件

1. 本章复习C++ I/O，并讨论如何格式化输出
2. 学习如何使用**类方法**来确定输入或输出流的状态
3. 了解输入类型是否匹配或者是否检测到了文件尾

> C++使用**继承**来派生用于管理文件输入和输出的类

4. 学习如何打开文件以进行输入和输出
5. 如何在文件中追加数据
6. 如何使用二进制文件
7. 如何获得对文件的**随机访问权**
8. 如何使用**标准的I/O方法**来读取和写入字符串

### 第18章 探讨C++新标准

1. 本章复习之前介绍过的几项C++11新功能，包括**新类型、统一的初始化语法、自动类型判断、新的智能指针以及作用域内枚举**
1. 讨论新增的**右值引用类型**以及如何使用它来实现移动语义
1. 介绍新增的**类功能、lambda表达式和可变参数模板**
1. 概述众多其他的新功能

### 附录A

计数系统

### 附录B

C++保留字

### 附录C

ASCII字符集

### 附录D

运算符优先级

### 附录E

其他运算符

### 附录F

模板类string

### 附录G

标准模板库方法和函数

### 附录H

精选读物和网上资源

### 附录I

转换ISO标准C++

### 附录J

复习题答案

## 本书约定

### 旁注

提供更深入的讨论和额外的背景知识，帮助阐明主题

### 提示

提供特定编程情形下很有帮助的简单指南

### 警告

提出潜在的陷阱

### 注意

提供不属于其他类型的各种说明

# 第1章 预备知识

C++在C语言的基础上添加了对**面向对象编程**和**泛型编程**的支持，基础了C语言**高效、简洁、快速和可移植性**的传统

> 面向对象的特性带来了全新的编程方法，这种方法是为了**应付复杂程度不断提高的现代编程任务**而设计的

## 1.1 C++简介

C++融合了3种不同的编程方式：

1. C语言代表的**过程性语言**
2. C++在C语言基础上添加的类代表的**面向对象语言**
3. C++模板支持的**泛型编程**

使用C++的原因之一是为了利用其面向对象的特性。要利用这种特性，必须对标准C语言知识有较深入的了解，因为它提供了基本类型、运算符、控制结构和语法规则。**从C过度到C++的学习量就和从头学习C语言一样大，而且必须摒弃一些编程习惯**。如果不了解C语言，则学习C++时需要掌握**C语言的知识、OOP知识以及泛型编程知识**

## 1.2 C++简史

体积更大、功能更强的计算机引出了更大、更复杂的程序，而这些程序在程序管理和维护方面带来了新的问题。20世纪70年代，**C和Pascal**这样的语言引领人们进入了**结构化编程时代**。

> **Pascal（结构化编程语言）:**
>
> Pascal的名称是为了纪念十七世纪法国著名哲学家和数学家Blaise Pascal而来的，它由瑞士Niklaus Wirth教授于六十年代末设计并创立的。Pascal语言语法严谨，层次分明，程序易写，可读性强，是第一个结构化编程语言。Pascal语言广泛用于各种软件，程序分为名称（program后自拟）、设置（var后规定）、开始（begin)、程序（正文）、读取（read/read ln）、结束（end），结构层次强，严谨而又紧密。

C还能生成**简洁、快速运行**的程序，并提供了**处理硬件问题的能力**（如管理通信端口和磁盘驱动器）。这些因素使C语言成为20世纪80年代占统治地位的编程语言。同时20世纪80年代人们也见证了一种新编程模式的成长：**面向对象编程（OPP）**，**SmallTalk和C++语言**具备这种功能

> **Smalltalk：**
>
> 被公认为历史上**第二个面向对象的程序设计语言**，和**第一个真正的集成开发环境**（IDE）。Smalltalk由艾伦·凯，Dan Ingalls，Ted Kaehler，Adele Goldberg等于70年代初在Xerox PARC开发。 Smalltalk对其它众多的程序设计语言的产生起到了极大的推动作用，主要有：C++，C#，Objective-C，Actor，Java和Ruby等。90年代的许多软件开发思想得利于Smalltalk，例如设计模式、敏捷编程和代码重构等。

### 1.2.1 C语言

20世纪70年代早期，**贝尔实验室的Dennis Ritchie**致力于开发**UNIX操作系统**，他需要一种能够**生成简洁、快速的程序，并且能有效地控制硬件的语言**

> **美国贝尔实验室：**
>
> **晶体管**、激光器、太阳能电池、发光二极管、数字交换机、通信卫星、电子数字计算机、**C语言**、**UNIX操作系统**、蜂窝移动通信设备、长途电视传送、仿真语言、有声电影、立体声录音，以及**通信网**等许多重大发明的诞生地
>
> 自1925年以来，贝尔实验室共获得两万五千多项专利，现在，平均每个工作日获得三项多专利。贝尔实验室的使命是为客户创造、生产和提供富有创新性的技术，这些技术使朗讯科技（Lucent Technologies）公司在通信系统、产品、元件和网络软件方面处于全球领先地位。一共获得8项（13人）诺贝尔奖（其中7项物理学奖，1项化学奖）
>
> **丹尼斯·里奇（Dennis Ritchie）：**
>
> 1941年9月9日-2011年10月12日，C语言之父，UNIX之父。曾担任朗讯科技公司贝尔实验室下属的计算机科学研究中心系统软件研究部的主任一职。1978年与布莱恩·科尔尼干（Brian W. Kernighan）一起出版了名著《C程序设计语言（The C Programming Language）》。此书已翻译成多种语言，被誉为c语言的圣经。2011年10月12日（北京时间为10月13日），丹尼斯·里奇去世，享年70岁。
>
> **操作系统：**
>
> 能够管理计算机资源、处理计算机与用户之间交互的一组程序

传统上，程序员使用**汇编语言**来满足这些需求。汇编语言依赖于计算机的内部机器语言，是**低级（low-level）语言，即直接操纵硬件**。因此汇编语言针对特定的计算机处理器，要将汇编程序移植到另一种计算机上，必须使用不同的汇编语言重新编写

UNIX是为在不同的计算机（或平台）上工作而设计的，这意味着它是一种高级语言。**高级（high-level）语言致力于解决问题，而不针对特定的硬件**。一种被称为**编译器**的特殊程序将高级语言翻译成特定的计算机的内部语言，这样就可以通过**对每个平台使用不同的编译器**来在不同的平台上使用同一个高级语言程序了

Ritchie希望有一种语言能将**低级语言的效率、硬件访问能力和高级语言的通用性、可移植性融合在一起**，于是他在旧语言的基础上开发了C语言

### 1.2.2 C语言编译原理

计算机语言要处理两个概念——**数据和算法**。数据是程序使用和处理的信息，而算法是程序使用的方法（见图1.1）

![image-20220126055009847](%E5%9B%BE%E7%89%87/image-20220126055009847.png)

C语言与当前最主流的语言一样，最初也是**过程性（procedural）语言**，这意味着它强调的是编程的算法方面。从概念上说，过程化编程**首先要确定计算机应采取的操作**，然后使用编程语言来实现这些操作。**程序命令计算机按一系列流程生成特定的结果**

#### 结构化编程

随着程序规模的扩大，早期的程序语言（如FORTRAN和BASIC）都会遇到组织方面的问题，很多旧式程序的执行路径很混乱（被称为“意大利面条式编程”），**几乎不可能通过阅读程序来理解它**，修改这种程序简直是一场灾难。为了解决这种问题，一种**更有序**的编程方法——**结构化编程（structured programming）**被开发出来

> **FORTRAN语言**是Formula Translation的缩写，意为“公式翻译”。它是为科学、工程问题或企事业管理中的那些能够用数学公式表达的问题而设计的，其数值计算的功能较强。 FORTRAN语言是世界上第一个被正式推广使用的高级语言。它是1954年被提出来的，1956年开始正式使用，直到2022年已有六十六年的历史，但仍历久不衰，它始终是数值计算领域所使用的主要语言
>
> **BASIC**（Beginners' All-purpose Symbolic Instruction Code，又译培基），意思就是“初学者通用符号指令代码”，是一种设计给初学者使用的程序设计语言。BASIC是一种**直译式的编程语言**，在完成编写后不须经由编译及连结等手续即可执行，但如果需要单独执行时仍然需要将其建立成执行档。 BASIC是由达特茅斯学院院长、匈牙利人约翰·凯梅尼（John G. Kemeny）与数学系教师托马斯·卡茨（Thomas E. Kurtz）共同研制出来的。1964年BASIC语言正式发布。第一个BASIC程序在1964年5月1日早上4时，由BASIC编译程序进行编译后成功运行。1975年，比尔·盖茨把它移植到PC上

**C语言具有结构化编程的特性**，C语言的词汇表中就包含了这些结构（for循环、while循环、do while循环和if else语句）

#### 自顶而下

另一个新原则是**自顶而下（top-down）**的设计。在C语言中，其**理念是将大型程序分解成小型、便于管理的任务**。这一过程将一直持续下去，直到将程序划分为小型的、易于编写的模块。C语言鼓励程序员**开发程序单元（函数）来表示各个任务模块**

**结构化编程技术反映了过程性编程的思想，根据执行的操作来构思一个程序**

### 1.2.3 面向对象编程

 虽然结构化编程的理念提高了程序的清晰度、可靠性，并使之便于维护，但它在编写大型程序时，仍面临着挑战。OOP提供了一种新方法，**与强调算法的过程性编程不同的是，OOP强调的是数据**。过程性编程是试图使问题满足语言的过程性方法，而OOP试图让语言满足问题的要求。其理念是设计与问题的本质特性相对应的数据格式

在C++中，类是一种规范，它描述了这种新型数据格式，**对象是根据这种规范构造的特定数据结构**。通常，类规定了可使用哪些数据来表示对象以及可以对这些数据执行哪些操作

**OOP程序设计方法首先设计类，他们准确地表示了程序要处理的东西，类定义描述了对每个类可执行的操作**。从低级组织（如类）到高级组织（如程序）的处理过程叫做**自下向上（bottom-up）的编程**

#### 意义

OOP编程并不仅仅是将数据和方法合并为类定义，它还可以：

1. 有助于**创建可重用的代码**，减少大量的工作
2. **信息隐藏**可以保护数据，使其免遭不适当的访问
3. **多态**可以为运算符和函数创建多个定义，通过编程上下文来确定使用哪个定义
4. **继承**可以使用旧类派生出新类

OOP引入了很多新的理念，使用的编程方法不同于过程性编程。**它不是将终点放在任务上，而是放在表示概念上**。**有时不一定使用自上而下的编程方法，而是使用自下而上的编程方法**

OOP语言使程序员在编程中能够轻松地使用已有的类。厂商提供了大量有用的类库，包括设计用于简化Windows或Macintosh环境下编程的类库

**C++真正的优点之一是：可以方便地重用和修改现有的、经过仔细测试的代码**

### 1.2.4 C++和泛型编程

**泛型编程（generic programming）**是C++支持的另一种编程模式。它与OOP的目标相同，即使重用代码和抽象通用概念的技术更简单。**OOP强调的是编程的数据方面，而泛型编程强调的是独立于特定数据类型**

OOP是一个管理大型项目的工具，而**泛型编程提供了执行常见任务的工具**

**术语泛型（generic）**指的是创建独立于类型的代码。泛型编程需要对语言进行扩展，以便可以只编写一个泛型（即不是特定类型的）函数，并将其用于各种实际类型。C++模板提供了完成这种任务的机制

### 1.2.5 C++的起源

C++和C一样，也是在贝尔实验室诞生的，**Bjarne Stroustrup**于20世纪80年代开发出了这种语言

> **本贾尼·斯特劳斯特卢普**（Bjarne Stroustrup，1950年6月11日-），丹麦人，计算机科学家，在德克萨斯A&M大学担任计算机科学的主席教授。他最著名的贡献就是开发了C++程序设计语言。1982年，美国AT&T公司贝尔实验室的本贾尼博士在C语言的基础上引入并扩充了面向对象的概念，发明了—种新的程序语言。为了表达该语言与C语言的渊源关系，它被命名为C++。而本贾尼博士被尊称为**C++语言之父。**

Stroustrup比较关心的是让C++更有用，而不是实施特定的编程原理或风格。在确定C++语言特性方面，**真正的编程需要比纯粹的原理更重要**

Stroustrup加入了OOP特性和对C的泛型编程支持，但并没有对C的组件作很大的改动。因此，**C++是C语言的超集**，任何有效的C程序都是有效的C++程序。**名称C++来自C语言中的递增运算符++。名称C++表明它是C的扩充版本**

**OOP部分赋予了C++语言将问题所涉及的概念联系起来的能力，C部分则赋予了C++语言紧密联系硬件的能力**（见图1.2），这种能力上的结合成就了C++的广泛传播

![image-20220126065432265](%E5%9B%BE%E7%89%87/image-20220126065432265.png)

在C++获得一定程度的成功后，Stroustrup才添加了模板，这使得进行泛型编程成为可能。在模板特性被使用和改进后，人们才逐渐认识到，它们和OOP同样重要——**甚至比OOP还重要**

C++融合了OOP、泛型编程和传统的过程性方法，这表明**C++强调的是实用价值，而不是意识形态方法**，这也是该语言获得成功的原因之一

## 1.3 可移植性和标准

